<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Incentive Calculator for FLS (ABCL RSB)</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f6f9;
        margin: 0;
        padding: 20px;
    }

    .container {
        max-width: 900px;
        margin: auto;
    }

    .card {
        background: #ffffff;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        margin-bottom: 20px;
    }

    h1 {
        text-align: center;
        color: #b00020;
        margin-bottom: 25px;
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
    }

    label {
        font-weight: bold;
        font-size: 14px;
        margin-bottom: 5px;
        display: block;
    }

    input {
        width: 100%;
        padding: 8px;
        border-radius: 6px;
        border: 1px solid #ccc;
    }

    input:focus {
        outline: none;
        border-color: #b00020;
    }

    .error {
        color: #b00020;
        font-size: 13px;
        margin-top: 5px;
    }

    .result-item {
        margin-bottom: 10px;
        font-size: 15px;
    }

    .highlight {
        font-weight: bold;
        font-size: 18px;
        color: #b00020;
    }

    .achievement-red { color: #b00020; }
    .achievement-orange { color: #ff9800; }
    .achievement-green { color: #2e7d32; }

    button {
        padding: 10px 15px;
        background: #b00020;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin-top: 10px;
    }

    button:hover {
        opacity: 0.9;
    }

</style>
</head>

<body>
<div class="container">

<h1>Incentive Calculator for FLS (ABCL RSB)</h1>

<div class="card">
<div class="grid">

<div>
<label>Amount Disbursed This Month (₹)</label>
<input type="number" id="disbursed" min="0" step="0.01">
</div>

<div>
<label>Target Assigned For The Month (₹)</label>
<input type="number" id="target" min="0" step="0.01">
</div>

<div>
<label>Number of Fresh Files Disbursed</label>
<input type="number" id="freshFiles" min="0" step="1">
</div>

<div>
<label>NPA in 0–6 MOB</label>
<input type="number" id="npa" min="0" step="1">
</div>

<div>
<label>Average Yield (%)</label>
<input type="number" id="yield" min="0" step="0.01">
</div>

</div>

<div class="error" id="errorMessage"></div>
<button onclick="resetForm()">Reset</button>
</div>

<div class="card">
<h3>Results</h3>

<div class="result-item">Achievement %: <span id="achievement"></span></div>
<div class="result-item">Slab Category: <span id="slab"></span></div>
<div class="result-item">Multiplier Applied: <span id="multiplier"></span></div>
<div class="result-item">Base Incentive: <span id="base"></span></div>
<div class="result-item">Additional Incentive: <span id="additional"></span></div>
<div class="result-item">Negative Incentive: <span id="negative"></span></div>
<div class="result-item highlight">Final Total Incentive: <span id="total"></span></div>

</div>
</div>

<script>

/* Utility: Currency Formatter */
function formatCurrency(value) {
    return "₹ " + Number(value).toLocaleString("en-IN", { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

/* Validation */
function validateInputs(disbursed, target, freshFiles, npa, yieldVal) {
    if (
        disbursed === "" || target === "" ||
        freshFiles === "" || npa === "" || yieldVal === ""
    ) return "All fields are required.";

    if (disbursed < 0 || target <= 0 || freshFiles < 0 || npa < 0 || yieldVal < 0)
        return "Values must be positive. Target cannot be zero.";

    return "";
}

/* Achievement Calculation */
function calculateAchievement(disbursed, target) {
    const achievement = disbursed / target;
    const percent = achievement * 100;
    return { achievement, percent };
}

/* Base Incentive Calculation */
function calculateBaseIncentive(achievement, disbursed, freshFiles) {

    if (achievement < 0.75 || freshFiles === 0) {
        return { multiplier: 0, slab: "Not Eligible", base: 0 };
    }

    let multiplier = 0;
    let slab = "";

    const getMultiplier = (lowAch, highAch, slabName, mapping) => {
        slab = slabName;
        if (freshFiles === 1) multiplier = mapping[1];
        else if (freshFiles === 2) multiplier = mapping[2];
        else if (freshFiles === 3) multiplier = mapping[3];
        else if (freshFiles >= 4 && freshFiles <= 5) multiplier = mapping[4];
        else if (freshFiles >= 6 && freshFiles <= 7) multiplier = mapping[6];
        else if (freshFiles >= 8) multiplier = mapping[8];
    };

    if (achievement >= 0.75 && achievement < 1.00) {
        getMultiplier(0.75, 1.00, "75%–99.99%", {
            1:0.2,2:0.3,3:0.4,4:0.5,6:0.6,8:0.7
        });
    } else if (achievement >= 1.00) {
        getMultiplier(1.00, Infinity, "100% and Above", {
            1:0.3,2:0.4,3:0.5,4:0.6,6:0.7,8:0.8
        });
    }

    const base = multiplier * disbursed;

    return { multiplier, slab, base };
}

/* Yield Bonus */
function calculateYieldBonus(base, yieldVal) {

    let percent = 0;

    if (yieldVal >= 14 && yieldVal <= 15) percent = 0.10;
    else if (yieldVal > 15 && yieldVal <= 16) percent = 0.15;
    else if (yieldVal > 16) percent = 0.20;

    return base * percent;
}

/* Negative Incentive */
function calculateNegativeKicker(base, npa) {

    let percent = 0;

    if (npa === 1) percent = 0.05;
    else if (npa > 1) percent = 0.10;

    return base * percent;
}

/* Final Total */
function calculateTotal(base, additional, negative) {
    let total = base + additional - negative;
    if (total < 0) total = 0;
    return total;
}

/* Main Engine */
function runCalculation() {

    const disbursed = parseFloat(document.getElementById("disbursed").value);
    const target = parseFloat(document.getElementById("target").value);
    const freshFiles = parseInt(document.getElementById("freshFiles").value);
    const npa = parseInt(document.getElementById("npa").value);
    const yieldVal = parseFloat(document.getElementById("yield").value);

    const error = validateInputs(disbursed, target, freshFiles, npa, yieldVal);
    document.getElementById("errorMessage").innerText = error;

    if (error) return;

    const { achievement, percent } = calculateAchievement(disbursed, target);

    if (achievement < 0.75) {
        document.getElementById("achievement").innerHTML = `<span class="achievement-red">${percent.toFixed(2)}%</span>`;
        document.getElementById("slab").innerText = "Not Eligible";
        document.getElementById("multiplier").innerText = "0";
        document.getElementById("base").innerText = formatCurrency(0);
        document.getElementById("additional").innerText = formatCurrency(0);
        document.getElementById("negative").innerText = formatCurrency(0);
        document.getElementById("total").innerText = formatCurrency(0);
        return;
    }

    const baseData = calculateBaseIncentive(achievement, disbursed, freshFiles);
    const additional = calculateYieldBonus(baseData.base, yieldVal);
    const negative = calculateNegativeKicker(baseData.base, npa);
    const total = calculateTotal(baseData.base, additional, negative);

    let achievementClass = "achievement-orange";
    if (achievement < 0.75) achievementClass = "achievement-red";
    else if (achievement >= 1.00) achievementClass = "achievement-green";

    document.getElementById("achievement").innerHTML =
        `<span class="${achievementClass}">${percent.toFixed(2)}%</span>`;

    document.getElementById("slab").innerText = baseData.slab;
    document.getElementById("multiplier").innerText = baseData.multiplier.toFixed(2);
    document.getElementById("base").innerText = formatCurrency(baseData.base);
    document.getElementById("additional").innerText = formatCurrency(additional);
    document.getElementById("negative").innerText = formatCurrency(negative);
    document.getElementById("total").innerText = formatCurrency(total);
}

/* Reset */
function resetForm() {
    document.querySelectorAll("input").forEach(i => i.value = "");
    document.querySelectorAll("#achievement, #slab, #multiplier, #base, #additional, #negative, #total")
        .forEach(el => el.innerText = "");
    document.getElementById("errorMessage").innerText = "";
}

/* Real-time calculation */
document.querySelectorAll("input").forEach(input => {
    input.addEventListener("input", runCalculation);
});

</script>

</body>
</html>
